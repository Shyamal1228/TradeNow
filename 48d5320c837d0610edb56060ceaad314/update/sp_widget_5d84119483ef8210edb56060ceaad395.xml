<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[function($scope, spUtil) {
    $scope.comments = $scope.data.comments;
}
]]></client_script>
        <controller_as>c</controller_as>
        <css>.journal-comments {
    margin: 20px 0;
}
.comment {
    border-bottom: 1px solid #ddd;
    padding: 10px 0;
}
.comment strong {
    font-size: 1.1em;
}
.comment span {
    color: #999;
    margin-left: 10px;
}
</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>false</has_preview>
        <id>chat</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>Chat</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
    // Get the sys_id of the item from the URL or other source
    var itemSysId = options.itemSysId;

    // Initialize an empty array to hold the journal entries
    data.comments = [];

    // Check if the itemSysId is provided
    if (itemSysId) {
        // Query the journal table for the specific item
        var gr = new GlideRecord('your_table_name'); // Replace with your actual table name
        gr.get(itemSysId);

        // Check if the record is found
        if (gr.isValidRecord()) {
            // Get the journal field (Lister comment)
            var journalEntries = gr.comments.getJournalEntry(-1); // -1 to get all entries

            // Loop through the journal entries and push them to the data.comments array
            for (var i = 0; i < journalEntries.length; i++) {
                data.comments.push({
                    timestamp: journalEntries[i].sys_created_on.getDisplayValue(),
                    user: journalEntries[i].sys_created_by.getDisplayValue(),
                    comment: journalEntries[i].value
                });
            }
        }
    }
})();
]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>jagriti</sys_created_by>
        <sys_created_on>2024-07-18 04:55:12</sys_created_on>
        <sys_id>5d84119483ef8210edb56060ceaad395</sys_id>
        <sys_mod_count>1</sys_mod_count>
        <sys_name>Chat</sys_name>
        <sys_package display_value="TradeNow" source="x_1383179_tradenow">48d5320c837d0610edb56060ceaad314</sys_package>
        <sys_policy/>
        <sys_scope display_value="TradeNow">48d5320c837d0610edb56060ceaad314</sys_scope>
        <sys_update_name>sp_widget_5d84119483ef8210edb56060ceaad395</sys_update_name>
        <sys_updated_by>jagriti</sys_updated_by>
        <sys_updated_on>2024-07-18 04:58:50</sys_updated_on>
        <template><![CDATA[<div class="journal-comments">
    <h3>Comments</h3>
    <div ng-repeat="comment in comments">
        <div class="comment">
            <strong>{{comment.user}}</strong> <span>{{comment.timestamp}}</span>
            <p>{{comment.comment}}</p>
        </div>
    </div>
</div>
]]></template>
    </sp_widget>
</record_update>
