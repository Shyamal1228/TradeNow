<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_rel_widget_clone">
    <sp_rel_widget_clone action="INSERT_OR_UPDATE">
        <child display_value="TN Comments">422e5a9c8327c210edb56060ceaad37a</child>
        <cloned>2024-07-18 10:16:54</cloned>
        <last_validated>2024-07-18 10:16:54</last_validated>
        <parent display_value="Comments">1e5ee379ebc5e5107f419f671352283f</parent>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;sp_widget&gt;&lt;category&gt;custom&lt;/category&gt;&lt;client_script&gt;&lt;![CDATA[api.controller = function($scope, $window, $http) {
    var c = this;
    var liveProfiles = {};
    liveProfiles[$scope.user] = {
        userID: $scope.user,
        name: $scope.user.name,
        initials: $window.NOW.user_initials
    };
    if ($window.NOW.user_avatar) {
        liveProfiles[$scope.user].userImage = $window.NOW.user_avatar;
    }

    c.getLiveProfileByUserId = function(userId) {
        return liveProfiles[userId];
    };

    var pending = {};

    //Little caching implementation to make sure we only get a given user's profile once.
    c.hasLiveProfile = function(userId) {
        if (!userId)
            return false;

        if (liveProfiles[userId])
            return true;

        if (pending[userId])
            return false;

        pending[userId] = $http.get('/api/now/live/profiles/sys_user.' + userId).then(function(response) {
            liveProfiles[userId] = {
                userID: userId,
                name: response.data.result.name,
                initials: buildInitials(response.data.result.name),
                avatar: response.data.result.avatar
            };
        });
        return false;
    };

    c.getUser = function(userName) {
        return buildInitials(userName);
    };

    function buildInitials(name) {
        if (!name)
            return "--";

        var initialMatchRegex = /^[A-ZÀ-Ÿ]|^[\u3040-\u309f]|^[\u30a0-\u30ff]|^[\uff66-\uff9f]|^[\u4e00-\u9faf]/;
        // Included Hiragana, Katakana, CJK Unified Ideographs and Halfwidth and Fullwidth Forms Blocks 
        // Hiragana -&gt; Japanese words, Katakana -&gt; foreign words
        // CJK Unified Ideographs -&gt; modern Chinese, Japanese, Korean and Vietnamese characters 

        var initials = name.split(" ").map(function(word) {
            return word.toUpperCase();
        }).filter(function(word) {
            return word.match(initialMatchRegex);
        }).map(function(word) {
            return word.substring(0, 1);
        }).join("");

        return (initials.length &gt; 3) ? initials.substr(0, 3) : initials;
    }
};]]&gt;&lt;/client_script&gt;&lt;controller_as&gt;c&lt;/controller_as&gt;&lt;css&gt;$background-primary: #ffffff !default;
$border-tertiary: #DADDE2 !default;
$border-primary: #8790A1 !default;
$font-size-h4: 18px !default;
$sp-space--lg: 16px !default;
$sp-space--xl: 24px !default;
$gray-light: #656E81 !default;
$headings-font-weight: 600 !default;
$font-size-h6: 14px !default;

.comment-timeline {
  position: relative;
  padding: $sp-space--xl 0px;
  list-style: none;
  width: 100%;
  background-color: $background-primary;

  .comment-timeline-item {
    display: flex;
    margin-bottom: 48px;
    width: 100%;

    .comment-timeline-badge {
      z-index: 1;
      margin-top: $sp-space--lg;
    }

    .comment-timeline-badge-initials {
      height: 4.8rem;
      width: 4.8rem;
      border-radius: 50%;
      border: 0.1rem solid $border-primary;
      font-weight: bold;
      text-align: center;

      .badge-initials {
        font-size: $font-size-h4;
        line-height: 4.8rem;
      }
    }

    .badge-initial-background {
      background-color: $background-primary;
    }

    .comment-timeline-panel {
      display: flex;
      padding-left: 20px;
      width: 100%;

      .comment-timeline-panel-inner {
        display: flex;
        flex-direction: column;
        padding: $sp-space--lg $sp-space--xl;
        width: 100%;
        border: 0.1rem solid $border-tertiary;
        border-radius: 0.4rem;
        -webkit-box-shadow: .1rem .1rem .3rem rgba(0, 0, 0, .1);
        box-shadow: .1rem .1rem .3rem rgba(0, 0, 0, .1);

        .comment-timeline-heading {
          display: flex;
          justify-content: space-between;
          flex-wrap: wrap;
          margin-bottom: $sp-space--lg;

          .comment-heading-title {
            font-size: $font-size-h4;
          }
        }

        p {
          margin-bottom: 0px;
        }
      }

      &amp;amp;:before {
        content: " ";
        position: absolute;
        left: 5.3rem;
        margin-top: 2.6rem;
        border-top: 1.5rem solid transparent;
        border-right: 1.5rem solid $border-tertiary;
        border-bottom: 1.5rem solid transparent;
      }

      &amp;amp;:after {
        content: " ";
        position: absolute;
        left: 5.4rem;
        margin-top: 2.6rem;
        border-top: 1.5rem solid transparent;
        border-right: 1.5rem solid $background-primary;
        border-bottom: 1.5rem solid transparent;
      }
    }

    &amp;amp;:before {
      content: "";
      position: absolute;
      top: 5rem;
      bottom: 5rem;
      left: 2.3rem;
      border-right: 0.2rem $border-tertiary solid;
    }
  }

  .comment-timeline-badge-start {
    height: 48px;
    width: 48px;
    background-color: $success;
    position: relative;
    border-radius: 50%;

    span {
      position:absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: $font-size-h6;
      color: $text-color;
    }
  }
}


.skeleton-loading {
  $loader-line-height: 20px;

  .skeleton-loader {
    animation: progress 2s ease-in-out infinite;
    background: rgb(239, 241, 246) no-repeat;
    background-image: linear-gradient(90deg, rgba(255, 255, 255, 0), rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0));
    background-size: 200px 100%;
    border-radius: 4px;
  }

  .name-loader {
    height: $loader-line-height;
    width: 20%;
  }

  .time-loader {
    height: $loader-line-height;
    width: 5%
  }

  .comment-loader {
    height: $loader-line-height;
    width: 70%
  }

  @keyframes progress {
    0% {
      background-position: -200px 0;
    }

    100% {
      background-position: calc(200px + 100%) 0;
    }
  }
}

.empty-state-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 100%;
  padding: 64px;
  background-color: $background-primary;
  
  i {
    font-size: 4.8rem;
    color: $gray-light;
  }
  span {
    font-size: $font-size-h4;
    font-weight: $headings-font-weight;
  }
}

&lt;/css&gt;&lt;data_table&gt;sp_instance&lt;/data_table&gt;&lt;demo_data/&gt;&lt;description/&gt;&lt;docs/&gt;&lt;field_list/&gt;&lt;has_preview&gt;false&lt;/has_preview&gt;&lt;id&gt;comments&lt;/id&gt;&lt;internal&gt;false&lt;/internal&gt;&lt;link&gt;&lt;![CDATA[function link(scope, element, attrs, controller) {
  
}]]&gt;&lt;/link&gt;&lt;name&gt;Comments&lt;/name&gt;&lt;option_schema/&gt;&lt;public&gt;false&lt;/public&gt;&lt;roles/&gt;&lt;script&gt;&lt;![CDATA[(function() {
    data.loading = input &amp;&amp; input.loading ? input.loading : options.loading;
    data.emptyState = input &amp;&amp; input.emptyState ? input.emptyState : options.emptyState;
    data.comments = input &amp;&amp; input.comments ? input.comments : options.comments;
})();]]&gt;&lt;/script&gt;&lt;servicenow&gt;false&lt;/servicenow&gt;&lt;sys_class_name&gt;sp_widget&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2023-02-17 09:00:03&lt;/sys_created_on&gt;&lt;sys_id&gt;1e5ee379ebc5e5107f419f671352283f&lt;/sys_id&gt;&lt;sys_mod_count&gt;1&lt;/sys_mod_count&gt;&lt;sys_name&gt;Comments&lt;/sys_name&gt;&lt;sys_package display_value="Employee Center" source="sn_ex_sp"&gt;4249e63a28d54d61bb6fbf61fd86cccb&lt;/sys_package&gt;&lt;sys_policy&gt;read&lt;/sys_policy&gt;&lt;sys_scope display_value="Employee Center"&gt;4249e63a28d54d61bb6fbf61fd86cccb&lt;/sys_scope&gt;&lt;sys_update_name&gt;sp_widget_1e5ee379ebc5e5107f419f671352283f&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2023-03-20 10:28:12&lt;/sys_updated_on&gt;&lt;template&gt;&lt;![CDATA[&lt;ul role="list" class="comment-timeline" aria-label="${Ticket history}" ng-if="data.loading || (data.comments &amp;&amp; data.comments.length &gt; 0)"&gt;
  &lt;li class="comment-timeline-item" ng-repeat="item in data.comments" ng-if="!data.loading"&gt;
    &lt;div class="comment-timeline-badge"&gt;
      &lt;div class="comment-timeline-badge-initials badge-initial-background" ng-if="!c.hasLiveProfile(item.user_sysId)"&gt;
        &lt;span class="badge-initials"&gt;{{c.getUser(item.user_name)}}&lt;/span&gt;
      &lt;/div&gt;
      &lt;sn-avatar-once ng-if="c.hasLiveProfile(item.user_sysId)" primary="c.getLiveProfileByUserId(item.user_sysId)" class="avatar-large" show-presence="true" enable-context-menu="false"/&gt;
    &lt;/div&gt;
    &lt;div class="comment-timeline-panel"&gt;
      &lt;div class="comment-timeline-panel-inner"&gt;
        &lt;div class="comment-timeline-heading"&gt;
          &lt;div class="comment-heading-title"&gt;{{::item.user_name}}&lt;/div&gt;
          &lt;small class="text-muted"&gt;
            &lt;span class="glyphicon glyphicon-time" aria-hidden="true"/&gt;
            &lt;sn-time-ago timestamp="item.created_on"&gt;&lt;/sn-time-ago&gt;
          &lt;/small&gt;
        &lt;/div&gt;
        &lt;p&gt;{{::item.comment}}&lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li class="comment-timeline-item skeleton-loading" ng-repeat="item in [1,2]" ng-if="data.loading"&gt;
    &lt;div class="comment-timeline-badge skeleton-loader comment-timeline-badge-initials"/&gt;
    &lt;div class="comment-timeline-panel"&gt;
      &lt;div class="comment-timeline-panel-inner"&gt;
        &lt;div class="comment-timeline-heading"&gt;
          &lt;div class="skeleton-loader name-loader" /&gt;
          &lt;small class="skeleton-loader time-loader"/&gt;
        &lt;/div&gt;
        &lt;p class="skeleton-loader comment-loader"/&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;div class="comment-timeline-badge comment-timeline-badge-start"&gt;
      &lt;span&gt;${Start}&lt;/span&gt;
    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div ng-if="data.emptyState &amp;&amp; !data.loading &amp;&amp; (!data.comments || (data.comments &amp;&amp; data.comments.length == 0))" class="empty-state-container"&gt;
  &lt;i class="fa fa-comments-o"/&gt;
  &lt;span&gt;${No comments to show}&lt;/span&gt;
&lt;/div&gt;]]&gt;&lt;/template&gt;&lt;/sp_widget&gt;</payload>
        <sys_class_name>sp_rel_widget_clone</sys_class_name>
        <sys_created_by>jagriti</sys_created_by>
        <sys_created_on>2024-07-18 10:16:54</sys_created_on>
        <sys_id>4a2e5a9c8327c210edb56060ceaad37d</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>422e5a9c8327c210edb56060ceaad37a</sys_name>
        <sys_package display_value="TradeNow" source="x_1383179_tradenow">48d5320c837d0610edb56060ceaad314</sys_package>
        <sys_policy/>
        <sys_scope display_value="TradeNow">48d5320c837d0610edb56060ceaad314</sys_scope>
        <sys_update_name>sp_rel_widget_clone_4a2e5a9c8327c210edb56060ceaad37d</sys_update_name>
        <sys_updated_by>jagriti</sys_updated_by>
        <sys_updated_on>2024-07-18 10:16:54</sys_updated_on>
    </sp_rel_widget_clone>
</record_update>
